DROP TABLE PERSON_STUDENT IF EXISTS;
DROP TABLE PERSON_PROFESSIONAL IF EXISTS;
DROP TABLE ADDRESS IF EXISTS;
DROP TABLE PERSON IF EXISTS;
DROP TABLE PERSON_TYPE IF EXISTS;

CREATE TABLE PERSON_TYPE (
    ID INTEGER generated by default as identity (start with 1) not null,  
    NAME varchar(50) not null,
    CREATED timestamp,
    CONSTRAINT IDX_PERSON_TYPE_ID PRIMARY KEY (ID)
);

CREATE TABLE PERSON (
    ID INTEGER generated by default as identity (start with 1) not null,  
    FIRSTNAME varchar(50) not null,
    LASTNAME varchar(50) not null,
    TYPE integer, 
    CREATED timestamp,
    CONSTRAINT IDX_PERSON_ID PRIMARY KEY (ID),
    CONSTRAINT FK_PERSON_TYPE FOREIGN KEY (TYPE) REFERENCES PERSON_TYPE(ID)
);

CREATE TABLE PERSON_STUDENT (
    ID integer not null,  
    SCHOOLNAME varchar(50) not null,
    CREATED timestamp,
    CONSTRAINT FK_PERSON_STUDENT_ID FOREIGN KEY (ID) REFERENCES PERSON(ID) on delete cascade
);

CREATE TABLE PERSON_PROFESSIONAL (
    ID integer not null,  
    COMPANYNAME varchar(50) not null,
    CREATED timestamp,
    CONSTRAINT FK_PERSON_PROFESSIONAL_ID FOREIGN KEY (ID) REFERENCES PERSON(ID) on delete cascade
);

CREATE TABLE ADDRESS (
    ID INTEGER generated by default as identity (start with 1) not null,
    PERSON_ID integer,  
    ADDRESS varchar(255),
    CITY varchar(50) not null,
    STATE varchar(50) null,
    COUNTRY varchar(50) not null,
    CREATED timestamp,
    CONSTRAINT IDX_ADDRESS_ID PRIMARY KEY (ID),
    CONSTRAINT FK_ADDRESS_PERSON_ID FOREIGN KEY (PERSON_ID) REFERENCES PERSON(ID) on delete cascade
);

INSERT INTO PERSON_TYPE(ID, NAME, CREATED) 
   VALUES(1, 'STUDENT', NOW());
INSERT INTO PERSON_TYPE(ID, NAME, CREATED) 
   VALUES(2, 'PROFESSIONAL', NOW());

INSERT INTO PERSON(ID, FIRSTNAME, LASTNAME, TYPE, CREATED)
   VALUES(1, 'Joe', 'Smith', 1, NOW());
INSERT INTO PERSON_STUDENT(ID, SCHOOLNAME, CREATED)
   VALUES(1, 'NYU', NOW());
INSERT INTO ADDRESS(ID, PERSON_ID, ADDRESS, CITY, STATE, COUNTRY, CREATED)
   VALUES(1, 1, '1060 West Addison St.', 'Chicago', 'IL', 'USA', NOW());

INSERT INTO PERSON(ID, FIRSTNAME, LASTNAME, TYPE, CREATED)
   VALUES(2, 'John', 'Wilson', 2, NOW());
INSERT INTO PERSON_PROFESSIONAL(ID, COMPANYNAME, CREATED)
   VALUES(2, 'Spring Pizza', NOW());
INSERT INTO ADDRESS(ID, PERSON_ID, ADDRESS, CITY, STATE, COUNTRY, CREATED)
   VALUES(2, 2, '2 Penn Plz # 15', 'New York', 'NY', 'USA', NOW());
INSERT INTO ADDRESS(ID, PERSON_ID, ADDRESS, CITY, STATE, COUNTRY, CREATED)
   VALUES(3, 2, '47 Howard St.', 'San Francisco', 'CA', 'USA', NOW());

INSERT INTO PERSON(ID, FIRSTNAME, LASTNAME, TYPE, CREATED)
   VALUES(3, 'Michael', 'Johnson', 2, NOW());
INSERT INTO PERSON_PROFESSIONAL(ID, COMPANYNAME, CREATED)
   VALUES(3, 'Spring Coffee', NOW());
INSERT INTO ADDRESS(ID, PERSON_ID, ADDRESS, CITY, STATE, COUNTRY, CREATED)
   VALUES(4, 3, '22 Penn Street', 'Los Angeles', 'CA', 'USA', NOW());
